<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Likelihood Functions for dosresmeta Models — mlprof.fun • dosresmeta</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Likelihood Functions for dosresmeta Models — mlprof.fun" />

<meta property="og:description" content="These functions compute the value of the log-likelihood for random-effects dose-response meta-analysis,
 in terms of model parameters. They are meant to be used internally and not directly run by the users." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dosresmeta</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Likelihood Functions for dosresmeta Models</h1>
    
    <div class="hidden name"><code>mlprof.fun.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>These functions compute the value of the log-likelihood for random-effects dose-response meta-analysis,
 in terms of model parameters. They are meant to be used internally and not directly run by the users.</p>
    
    </div>

    <pre class="usage"><span class='fu'>remlprof.fn</span>(<span class='no'>par</span>, <span class='no'>Xlist</span>, <span class='no'>Zlist</span>, <span class='no'>ylist</span>, <span class='no'>Slist</span>, <span class='no'>nalist</span>, <span class='no'>q</span>, <span class='no'>nall</span>, <span class='no'>ctrl</span>)

<span class='fu'>remlprof.gr</span>(<span class='no'>par</span>, <span class='no'>Xlist</span>, <span class='no'>ylist</span>, <span class='no'>Slist</span>, <span class='no'>nalist</span>, <span class='no'>p</span>, <span class='no'>nall</span>, <span class='no'>ctrl</span>)

<span class='fu'>mlprof.fn</span>(<span class='no'>par</span>, <span class='no'>Xlist</span>, <span class='no'>Zlist</span>, <span class='no'>ylist</span>, <span class='no'>Slist</span>, <span class='no'>nalist</span>, <span class='no'>q</span>, <span class='no'>nall</span>, <span class='no'>ctrl</span>)

<span class='fu'>mlprof.gr</span>(<span class='no'>par</span>, <span class='no'>Xlist</span>, <span class='no'>ylist</span>, <span class='no'>Slist</span>, <span class='no'>nalist</span>, <span class='no'>p</span>, <span class='no'>nall</span>, <span class='no'>ctrl</span>)

<span class='fu'>iter.igls</span>(<span class='no'>Psi</span>, <span class='no'>Xlist</span>, <span class='no'>Zlist</span>, <span class='no'>ylist</span>, <span class='no'>Slist</span>, <span class='no'>nalist</span>, <span class='no'>q</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>par</th>
      <td><p>a vector representing the random-effects parameters defining the between-study (co)variance matrix.</p></td>
    </tr>
    <tr>
      <th>Xlist</th>
      <td><p>a m-dimensional list of study-specific design matrices for the fixed-effects part of the model.</p></td>
    </tr>
    <tr>
      <th>Zlist</th>
      <td><p>a m-dimensional list of study-specific design matrices for the random-effects part of the model.</p></td>
    </tr>
    <tr>
      <th>ylist</th>
      <td><p>a m-dimensional list of study-specific of vectors of estimated outcomes.</p></td>
    </tr>
    <tr>
      <th>Slist</th>
      <td><p>a m-dimensional list of within-study (co)variance matrices of estimated outcomes.</p></td>
    </tr>
    <tr>
      <th>nalist</th>
      <td><p>a m-dimensional list of k-dimensional study-specific logical vectors, identifying missing outcomes.</p></td>
    </tr>
    <tr>
      <th>ctrl</th>
      <td><p>list of parameters for controlling the fitting process, usually internally set to default values by 
<code>dosresmeta.control</code>.</p></td>
    </tr>
    <tr>
      <th>p, q, nall</th>
      <td><p>numeric scalars: number of predictors, number of observations (excluding missing).</p></td>
    </tr>
    <tr>
      <th>Psi</th>
      <td><p>a p x p matrix representing the current estimate of the between-study (co)variance matrix.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>mlprof.fn</code> and <code>remlprof.fn</code> return the value of the (restricted) log-likelihood for a given set of 
parameters in <code>par</code>. <code>iter.igls</code> returns an updated estimate of <code>Psi</code> given its initial value or the value at 
the previous iteration.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>These functions are called internally by the fitting functions <code><a href='dosresmeta.ml.html'>dosresmeta.ml</a></code> and <code><a href='dosresmeta.ml.html'>dosresmeta.reml</a></code> to 
perform iterative optimization algorithms for estimating random effects meta-analytical models.</p>
<p>The maximization of the (restricted) likelihood starts with few runs of an iterative generalized least square algorithm implemented in <code>iter.igls</code>. 
This can be regarded as a fast and stable way to get starting values close to the maximum for the Quasi-Newton iterative algorithm, implemented in 
<code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code>. Alternatively, starting values can be provided by the user in the control list (see <code>mixmeta.control</code>).</p>
<p>These functions actually specify the profiled version of the (restricted) likelihood, expressed only in terms of random-effects parameters, while the 
estimate of the fixed-effects coefficients is provided at each iteration by the internal function <code>glsfit</code>, based on the current value of 
the between-study (co)variance matrix. At convergence, the value of this profiled version is identical to the full (restricted) likelihood. 
This approach is computationally efficient, as it reduces the number of parameters in the optimization routine.</p>
<p>The parameterization of the between-study (co)variance matrix ensures the positive-definiteness of the estimated matrix. A Cholesky decomposition is then 
performed on the marginal (co)variance matrix in order to re-express the problem as standard least square equations, an approach which speeds up the 
computation of matrix inverses and determinants. These equations are finally solved through a QR decomposition, which guarantees stability.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code>dosresmeta</code>, <code>mixmeta.fit</code>, <code><a href='dosresmeta.control.html'>dosresmeta.control</a></code>, <code>mlprof.fn</code></p></div>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
          </ul>

    <h2>Author</h2>
    <p>Alessio Crippa, <a href='mailto:alessio.crippa@ki.se'>alessio.crippa@ki.se</a></p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alessio Crippa.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9100.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


